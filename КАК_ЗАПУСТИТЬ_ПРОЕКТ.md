# Пошаговая инструкция: как запустить и сохранить проект CRM

## Часть 1. Установка Node.js (один раз)

Если команда `npm` не работает, нужно установить Node.js.

### Шаг 1.1. Скачать Node.js
1. Откройте браузер.
2. Перейдите на сайт: **https://nodejs.org/ru**
3. На главной странице нажмите зелёную кнопку **«LTS»** (рекомендуемая версия).
4. Файл `node-vXX.XX.X-x64.msi` начнёт скачиваться. Дождитесь окончания.

### Шаг 1.2. Установить Node.js
1. Откройте папку **Загрузки** и дважды щёлкните по скачанному файлу `.msi`.
2. Нажмите **Next** (Далее).
3. Примите условия лицензии, нажмите **Next**.
4. Оставьте путь по умолчанию (`C:\Program Files\nodejs\`), нажмите **Next**.
5. **Важно:** на экране «Custom Setup» убедитесь, что отмечено **«Add to PATH»**. Нажмите **Next**.
6. Нажмите **Install**. Если появится запрос от администратора — нажмите **Да**.
7. Когда установка закончится, нажмите **Finish**.

### Шаг 1.3. Проверить установку
1. **Полностью закройте Cursor** (все окна).
2. Снова откройте Cursor и откройте папку проекта `C:\11`.
3. Откройте терминал: меню **Terminal** → **New Terminal** (или `` Ctrl+` ``).
4. Введите по очереди и нажимайте Enter после каждой строки:

```
node --version
```

Должна появиться версия, например: `v20.10.0`.

```
npm --version
```

Должна появиться версия, например: `10.2.3`.

Если обе команды показывают версии — Node.js установлен правильно. Переходите к Части 2.

---

## Часть 2. Запуск проекта CRM

Все команды вводите в терминале Cursor (внизу экрана), после каждой нажимайте **Enter**.

### Шаг 2.1. Перейти в папку проекта
```
cd C:\11
```

### Шаг 2.2. Установить зависимости (один раз после клонирования или если папки node_modules нет)
```
npm install
```

Подождите, пока установятся пакеты. В конце не должно быть красных ошибок.

### Шаг 2.3. Запустить сервер разработки
```
npm run dev
```

Должно появиться что-то вроде:
- `▲ Next.js 16.x.x`
- `- Local: http://localhost:3000`

### Шаг 2.4. Открыть проект в браузере
1. Откройте браузер (Chrome, Edge и т.д.).
2. В адресной строке введите: **http://localhost:3000**
3. Нажмите Enter.

Откроется ваше CRM-приложение. Чтобы остановить сервер — в терминале нажмите **Ctrl+C**.

---

## Часть 3. Сохранение проекта

### Сохранение файлов (код)
- В Cursor нажимайте **Ctrl+S** в открытом файле — файл сохранится на диск.
- Или **File → Save All** — сохранятся все изменённые файлы.

Ваш проект уже лежит в папке `C:\11` на компьютере — всё, что вы сохраняете, остаётся там.

### Резервная копия (на всякий случай)
1. Скопируйте всю папку `C:\11` (правый клик → Копировать).
2. Вставьте её, например, на рабочий стол или в «Документы» с именем `C:\11_backup_дата`.

### Сборка для продакшена (если понадобится потом)
В терминале в папке `C:\11`:
```
npm run build
```
Соберётся папка `.next` — это готовое приложение. Запуск без dev-режима:
```
npm start
```

---

## Если что-то пошло не так

| Проблема | Что сделать |
|----------|-------------|
| `npm` не распознаётся после установки Node | Закройте Cursor полностью, откройте снова, снова откройте терминал. |
| Ошибка при `npm install` | Проверьте интернет. Попробуйте снова `npm install`. |
| Порт 3000 занят | В терминале выполните: `$env:PORT=3001; npm run dev` — тогда откройте http://localhost:3001 |
| Страница не открывается | Убедитесь, что в терминале всё ещё запущен `npm run dev` и нет красных ошибок. |

Если опишете точную ошибку (скопируете текст из терминала), можно будет подсказать точнее.

---

## Часть 4. Доступ с любого устройства — деплой в облако (Vercel)

Если нужно открывать CRM не только на этом компьютере по `localhost`, а с телефона, планшета или другого города — приложение нужно выложить в интернет. Ниже — подробно каждый шаг.

### Шаг 4.1. Залить проект в GitHub

**4.1.1. Установить Git (если ещё не установлен)**  
1. Откройте https://git-scm.com/download/win  
2. Скачайте установщик и запустите его.  
3. Оставьте настройки по умолчанию, нажимайте **Next** до конца, затем **Finish**.  
4. Закройте и снова откройте терминал в Cursor.

**4.1.2. Проверить Git**  
В терминале в папке `C:\11` введите:
```
git --version
```
Должна появиться версия (например, `git version 2.43.0`).

**4.1.3. Создать аккаунт на GitHub (если нет)**  
1. Откройте https://github.com  
2. Нажмите **Sign up**.  
3. Введите email, придумайте пароль и имя пользователя.  
4. Подтвердите email по письму от GitHub.

**4.1.4. Создать новый репозиторий на GitHub**  
1. Войдите на https://github.com  
2. Справа вверху нажмите **+** → **New repository**.  
3. **Repository name:** например, `crm-11` (латиница, без пробелов).  
4. Оставьте **Public**.  
5. **Не ставьте** галочки «Add a README» и «Add .gitignore» — репозиторий должен быть пустым.  
6. Нажмите **Create repository**.  
7. На следующей странице скопируйте URL репозитория — он выглядит так: `https://github.com/ВАШ_ЛОГИН/crm-11.git` (у вас будет ваш логин и имя репо).

**4.1.5. Инициализировать Git в проекте и отправить код**  
В терминале в папке `C:\11` выполните команды **по одной**, после каждой нажимайте Enter:

```
git init
```
Создаётся скрытая папка `.git` в проекте.

```
git add .
```
Добавляются все файлы в «очередь» на коммит. Файлы из `.gitignore` (в том числе `.env.local` и `node_modules`) не попадут в репозиторий — это правильно.

```
git commit -m "Первый коммит: CRM проект"
```
Создаётся первый коммит (сохранённая версия проекта).

```
git branch -M main
```
Главная ветка называется `main`.

```
git remote add origin https://github.com/ВАШ_ЛОГИН/crm-11.git
```
**Важно:** замените `ВАШ_ЛОГИН` и `crm-11` на ваш логин GitHub и имя репозитория из шага 4.1.4.

```
git push -u origin main
```
При первом `push` браузер может открыться и попросить войти в GitHub (или ввести логин/пароль в терминале). После успешной отправки на странице репозитория на GitHub появятся все файлы проекта (без `node_modules` и без `.env.local`).

---

### Шаг 4.2. Зайти на Vercel и войти через GitHub

**4.2.1.** Откройте в браузере: **https://vercel.com**

**4.2.2.** Нажмите **Sign Up** (или **Log In**, если уже регистрировались).

**4.2.3.** Выберите **Continue with GitHub** — войдите через аккаунт GitHub.  
Разрешите Vercel доступ к вашему GitHub (кнопка **Authorize** или **Установить**). Так Vercel сможет читать ваши репозитории и автоматически деплоить при каждом обновлении.

**4.2.4.** После входа вы попадёте в дашборд Vercel (список проектов). Если проектов ещё нет — список будет пустой.

---

### Шаг 4.3. Импортировать репозиторий и добавить переменные из .env.local

**4.3.1. Импорт репозитория**  
1. На главной странице Vercel нажмите **Add New…** → **Project**.  
2. В списке появятся репозитории из GitHub. Найдите ваш (например, `crm-11`) и нажмите **Import** рядом с ним.  
3. Если репозитория нет — нажмите **Adjust GitHub App Permissions** и выдайте Vercel доступ к нужной организации/аккаунту, затем обновите страницу.

**4.3.2. Настройка проекта перед деплоем**  
На экране настроек проекта:

- **Project Name** — можно оставить как есть или изменить (например, `crm-11`). Это будет часть URL: `https://crm-11.vercel.app`.
- **Framework Preset** — Vercel обычно сам определит **Next.js**, ничего менять не нужно.
- **Root Directory** — оставьте пустым (проект в корне репозитория).
- **Build and Output Settings** — оставьте по умолчанию.

**4.3.3. Добавить переменные окружения (обязательно)**  
Без них приложение не сможет подключиться к Supabase.

1. Раскройте блок **Environment Variables**.  
2. Откройте на компьютере файл `C:\11\.env.local` в блокноте или в Cursor (значения не показывайте никому и не публикуйте).

Добавьте **три** переменные по одной:

| Name (имя) | Value (значение) — скопируйте из .env.local |
|------------|---------------------------------------------|
| `NEXT_PUBLIC_SUPABASE_URL` | Вся строка после `=` у `NEXT_PUBLIC_SUPABASE_URL` (URL вида `https://xxxx.supabase.co`) |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Вся строка после `=` у `NEXT_PUBLIC_SUPABASE_ANON_KEY` (длинный JWT-токен) |
| `SUPABASE_SERVICE_ROLE_KEY` | Вся строка после `=` у `SUPABASE_SERVICE_ROLE_KEY` (длинный JWT-токен) |

Как добавить каждую переменную на Vercel:  
- В поле **Key** введите имя (например, `NEXT_PUBLIC_SUPABASE_URL`).  
- В поле **Value** вставьте значение из `.env.local` (без кавычек и без пробелов в начале/конце).  
- **Environment:** отметьте **Production** (можно дополнительно **Preview** и **Development**, если планируете тестовые деплои).  
- Нажмите **Add** или **Save**.  
- Повторите для двух оставшихся переменных.

**4.3.4.** Убедитесь, что все три переменные отображаются в списке (значения Vercel скрывает звёздочками — это нормально).

---

### Шаг 4.4. Запустить деплой и получить постоянный URL

**4.4.1.** Нажмите кнопку **Deploy** внизу страницы.

**4.4.2.** Vercel начнёт сборку: скачает код из GitHub, установит зависимости (`npm install`), выполнит сборку (`npm run build`). В логе будут строки вроде «Building…», «Running npm run build». Обычно это 1–3 минуты.

**4.4.3.** Если сборка прошла успешно:  
- Появится надпись **Congratulations!** и ссылка вида **https://ваш-проект.vercel.app**.  
- Нажмите **Visit** или скопируйте эту ссылку.

**4.4.4.** Откройте эту ссылку в браузере на любом устройстве (телефон, другой компьютер, другая сеть). CRM должна открываться и работать с теми же данными Supabase — база уже в облаке, менять в ней ничего не нужно.

**Если сборка упала с ошибкой:**  
- В том же окне Vercel откройте вкладку **Building** или **Logs** и посмотрите красные строки.  
- Частая причина — не добавлена одна из переменных окружения или опечатка в имени (должно быть точно `NEXT_PUBLIC_SUPABASE_URL`, а не `SUPABASE_URL`).  
- Исправьте переменные: **Project → Settings → Environment Variables**, добавьте/исправьте и сделайте **Redeploy** на вкладке **Deployments**.

---

### Дальнейшие обновления

После того как вы что-то меняете в коде и снова отправляете в GitHub:

```
git add .
git commit -m "Описание изменений"
git push
```

Vercel сам сделает новый деплой (обычно через 1–2 минуты), и обновлённая версия будет доступна по тому же URL. Отдельно нажимать Deploy не обязательно.
